{
  "workflow": {
    "unique_name": "definition_workflow_020Y4P7XXR77L4xZN5IOho9col6EBkt0COs",
    "name": "V2 Umbrella - Destination Lists URLs to SecureX Intel",
    "title": "V2 Umbrella - Destination Lists URLs to SecureX Intel",
    "type": "generic.workflow",
    "base_type": "workflow",
    "variables": [
      {
        "schema_id": "tabletype_01N76TJTB7W9W2xVeTE6lQJYbRC7EkZJ4z8",
        "properties": {
          "scope": "local",
          "name": "Unknown Observables",
          "type": "datatype.table",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_020Y4P7Y85GN91WVM3oTK10DNiOWS5Tf0OP",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "Indicator ID",
          "type": "datatype.string",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_020Y4P7Y852EJ5kszSE8231jGZv0XgDdiHX",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "tabletype_01N76TJTB7W9W2xVeTE6lQJYbRC7EkZJ4z8",
        "properties": {
          "scope": "local",
          "name": "Known Observables",
          "type": "datatype.table",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_020Y4P7Y859E36aoHsOrg24teqwE9aUlKRf",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "{\"destinations\":[]}",
          "scope": "local",
          "name": "Umbrella Full List",
          "type": "datatype.string",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_020ZVPN3NK6WN7VkLCbOhjc8T8vcbHGAxyr",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "Umbrella SECUREX TEST",
          "scope": "input",
          "name": "Indicator-Feed Name",
          "type": "datatype.string",
          "is_required": true,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_020Y4P7Y84GDP5WLUyBaugzUBfMVu1GlsFy",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "Feed Details",
          "type": "datatype.string",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_020Y62SMOXCHA4qBtbzlO4QyDznerSuDbpB",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.integer",
        "properties": {
          "value": 1,
          "scope": "local",
          "name": "Inetrator",
          "type": "datatype.integer",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_020Y6Y8U99CR34isCj0O9GlVDbig83Jdv2f",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "SecureX TEST DST",
          "scope": "local",
          "name": "Umbrella Destination List Name",
          "type": "datatype.string",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_020Y6CTDZ1O1G6fiIcDFXIDEgMQfe49m8Bm",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "Private Intel Group Id",
          "type": "datatype.string",
          "is_required": false,
          "is_invisible": false
        },
        "unique_name": "variable_workflow_020Y4P7Y84UUF7dPuOqsFyCPTmuDWSR2r6D",
        "object_type": "variable_workflow"
      }
    ],
    "properties": {
      "atomic": {
        "is_atomic": false
      },
      "delete_workflow_instance": false,
      "display_name": "V2 Umbrella - Destination Lists URLs to SecureX Intel",
      "runtime_user": {
        "target_default": true
      },
      "target": {
        "execute_on_target_group": true,
        "target_group": {
          "target_group_id": "target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH",
          "run_on_all_targets": false,
          "selected_target_types": [
            "web-service.endpoint"
          ],
          "use_criteria": {
            "choose_target_using_algorithm": "choose_first_with_matching_criteria",
            "conditions": [
              {
                "operator": "eq",
                "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                "right_operand": "CTR_API"
              }
            ]
          }
        }
      }
    },
    "object_type": "definition_workflow",
    "actions": [
      {
        "unique_name": "definition_activity_020Y4P8AXCPG364eWoK6cPWTBuqec2CdyXs",
        "name": "Group",
        "title": "Get Private Intelligence Group Info",
        "type": "logic.group",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Get Private Intelligence Group Info",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "actions": [
          {
            "unique_name": "definition_activity_020Y4P8CT7YOE1u9n9BkBF76ROj6lbwSH7Y",
            "name": "HTTP Request",
            "title": "Search All Events for Private Intel Group ID",
            "type": "web-service.http_request",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "allow_auto_redirect": true,
              "allow_headers_redirect": false,
              "content_type": "application/json",
              "continue_on_error_status_code": false,
              "continue_on_failure": false,
              "display_name": "Search All Events for Private Intel Group ID",
              "method": "GET",
              "relative_url": "/ctia/event/search",
              "runtime_user": {
                "target_default": true
              },
              "skip_execution": false,
              "target": {
                "override_workflow_target": true,
                "target_id": "definition_target_01K5COU2P4BJ93qEsN20qTZ7JxYaSsM3m36"
              }
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_020Y4P8ELY2IO3DRuNgHvs4DhUicUqZlk5B",
            "name": "JSONPath Query",
            "title": "Extract ID from Response",
            "type": "corejava.jsonpathquery",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "continue_on_failure": false,
              "display_name": "Extract ID from Response",
              "input_json": "$activity.definition_activity_020Y4P8CT7YOE1u9n9BkBF76ROj6lbwSH7Y.output.response_body$",
              "jsonpath_queries": [
                {
                  "jsonpath_query": "$[0].groups[0]",
                  "jsonpath_query_name": "group_id",
                  "jsonpath_query_type": "string"
                }
              ],
              "skip_execution": false
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_020Y4P8G1G28P2F2vNEXOnLNmB0TobBBUhu",
            "name": "Set Variables",
            "title": "Set Local Group ID",
            "type": "core.set_multiple_variables",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Set Local Group ID",
              "skip_execution": false,
              "variables_to_update": [
                {
                  "variable_to_update": "$workflow.definition_workflow_020Y4P7XXR77L4xZN5IOho9col6EBkt0COs.local.variable_workflow_020Y4P7Y84UUF7dPuOqsFyCPTmuDWSR2r6D$",
                  "variable_value_new": "$activity.definition_activity_020Y4P8ELY2IO3DRuNgHvs4DhUicUqZlk5B.output.jsonpath_queries.group_id$"
                }
              ]
            },
            "object_type": "definition_activity"
          }
        ]
      },
      {
        "unique_name": "definition_activity_020Y4P8H8WPXE5TQMLTiEaUx61iSJnrBsic",
        "name": "Group",
        "title": "Validate/Create Indicator",
        "type": "logic.group",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Validate/Create Indicator",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "actions": [
          {
            "unique_name": "definition_activity_020Y4P8J29DEE2bziwFjUVo8NqZU3cTlzwX",
            "name": "HTTP Request",
            "title": "Get Indicators",
            "type": "web-service.http_request",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "allow_auto_redirect": true,
              "allow_headers_redirect": false,
              "content_type": "application/json",
              "continue_on_error_status_code": false,
              "continue_on_failure": false,
              "display_name": "Get Indicators",
              "method": "GET",
              "relative_url": "/ctia/indicator/search",
              "runtime_user": {
                "target_default": true
              },
              "skip_execution": false,
              "target": {
                "override_workflow_target": true,
                "target_id": "definition_target_01K5COU2P4BJ93qEsN20qTZ7JxYaSsM3m36"
              }
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_020Y4P8KR0LR21zJfR7bveCrgFcGU5EuOIn",
            "name": "JSONPath Query",
            "title": "Check for Indicator",
            "type": "corejava.jsonpathquery",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "continue_on_failure": true,
              "display_name": "Check for Indicator",
              "input_json": "$activity.definition_activity_020Y4P8J29DEE2bziwFjUVo8NqZU3cTlzwX.output.response_body$",
              "jsonpath_queries": [
                {
                  "jsonpath_query": "$[?(@.title == '$workflow.definition_workflow_020Y4P7XXR77L4xZN5IOho9col6EBkt0COs.input.variable_workflow_020Y4P7Y84GDP5WLUyBaugzUBfMVu1GlsFy$')].id",
                  "jsonpath_query_name": "indicator_id",
                  "jsonpath_query_type": "string"
                }
              ],
              "skip_execution": false
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_020Y4P8M0W1WQ7FBOgnEclXi5ZNcwyhMCdT",
            "name": "Condition Block",
            "title": "If Indicator Check",
            "type": "logic.if_else",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "If Indicator Check",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "blocks": [
              {
                "unique_name": "definition_activity_020Y4P8N2VQOO44uXSBRVTC5sq83R3vS4ZF",
                "name": "Condition Branch",
                "title": "Fails",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": "$activity.definition_activity_020Y4P8KR0LR21zJfR7bveCrgFcGU5EuOIn.output.succeeded$",
                    "operator": "eq",
                    "right_operand": false
                  },
                  "continue_on_failure": false,
                  "display_name": "Fails",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_020Y4P8OLJD9L24jW3DyMxDwo6NNTLlLMne",
                    "name": "HTTP Request",
                    "title": "Create Indicator",
                    "type": "web-service.http_request",
                    "base_type": "activity",
                    "properties": {
                      "action_timeout": 180,
                      "allow_auto_redirect": true,
                      "allow_headers_redirect": false,
                      "body": "{\n    \"description\": \"SecureX indicator to collect judgements sources from Umbrella Destination List\",\n    \"valid_time\": {\n      \"start_time\": \"2021-11-08T21:30:29.991Z\",\n      \"end_time\": \"2525-01-01T00:00:00.000Z\"\n    },\n    \"producer\": \"$workflow.definition_workflow_020Y4P7XXR77L4xZN5IOho9col6EBkt0COs.input.variable_workflow_020Y4P7Y84GDP5WLUyBaugzUBfMVu1GlsFy$\",\n    \"schema_version\": \"1.1.3\",\n    \"type\": \"indicator\",\n    \"short_description\": \"Indicator to collect judgements sources from Umbrella Destination List\",\n    \"title\": \"$workflow.definition_workflow_020Y4P7XXR77L4xZN5IOho9col6EBkt0COs.input.variable_workflow_020Y4P7Y84GDP5WLUyBaugzUBfMVu1GlsFy$\",\n    \"severity\": \"High\",\n    \"tlp\": \"red\",\n    \"confidence\": \"High\",\n    \"authorized_groups\": [\n    \"$workflow.definition_workflow_020Y4P7XXR77L4xZN5IOho9col6EBkt0COs.local.variable_workflow_020Y4P7Y84UUF7dPuOqsFyCPTmuDWSR2r6D$\"\n    ]\n  }",
                      "content_type": "application/json",
                      "continue_on_error_status_code": false,
                      "continue_on_failure": false,
                      "display_name": "Create Indicator",
                      "method": "POST",
                      "relative_url": "/ctia/indicator",
                      "runtime_user": {
                        "target_default": true
                      },
                      "skip_execution": false,
                      "target": {
                        "override_workflow_target": true,
                        "target_id": "definition_target_01K5COU2P4BJ93qEsN20qTZ7JxYaSsM3m36"
                      }
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_020Y4P8Q4KB5X4IMpU0SUW95Cy7TjiTZV88",
                    "name": "JSONPath Query",
                    "title": "Extract Indicator",
                    "type": "corejava.jsonpathquery",
                    "base_type": "activity",
                    "properties": {
                      "action_timeout": 180,
                      "continue_on_failure": false,
                      "display_name": "Extract Indicator",
                      "input_json": "$activity.definition_activity_020Y4P8OLJD9L24jW3DyMxDwo6NNTLlLMne.output.response_body$",
                      "jsonpath_queries": [
                        {
                          "jsonpath_query": "$.id",
                          "jsonpath_query_name": "indicator_id",
                          "jsonpath_query_type": "string"
                        }
                      ],
                      "skip_execution": false
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_020Y4P8RH9PHE1sClWgZXxh9t1okriBfOXX",
                    "name": "Set Variables",
                    "title": "Update Local Indicator",
                    "type": "core.set_multiple_variables",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Update Local Indicator",
                      "skip_execution": false,
                      "variables_to_update": [
                        {
                          "variable_to_update": "$workflow.definition_workflow_020Y4P7XXR77L4xZN5IOho9col6EBkt0COs.local.variable_workflow_020Y4P7Y852EJ5kszSE8231jGZv0XgDdiHX$",
                          "variable_value_new": "$activity.definition_activity_020Y4P8Q4KB5X4IMpU0SUW95Cy7TjiTZV88.output.jsonpath_queries.indicator_id$"
                        }
                      ]
                    },
                    "object_type": "definition_activity"
                  }
                ]
              },
              {
                "unique_name": "definition_activity_020Y4P8SPGETV3MWvHJcoEWWT8TQwI3l1Az",
                "name": "Condition Branch",
                "title": "Succeeds",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": "$activity.definition_activity_020Y4P8KR0LR21zJfR7bveCrgFcGU5EuOIn.output.succeeded$",
                    "operator": "eq",
                    "right_operand": true
                  },
                  "continue_on_failure": false,
                  "display_name": "Succeeds",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_020Y4P8U84UDL6ADMLVqcHaGHrmy0yRIK5j",
                    "name": "Set Variables",
                    "title": "Update Local Indicator",
                    "type": "core.set_multiple_variables",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Update Local Indicator",
                      "skip_execution": false,
                      "variables_to_update": [
                        {
                          "variable_to_update": "$workflow.definition_workflow_020Y4P7XXR77L4xZN5IOho9col6EBkt0COs.local.variable_workflow_020Y4P7Y852EJ5kszSE8231jGZv0XgDdiHX$",
                          "variable_value_new": "$activity.definition_activity_020Y4P8KR0LR21zJfR7bveCrgFcGU5EuOIn.output.jsonpath_queries.indicator_id$"
                        }
                      ]
                    },
                    "object_type": "definition_activity"
                  }
                ]
              }
            ]
          }
        ]
      },
      {
        "unique_name": "definition_activity_020Y4P8VBV7R11yecI0J0ODpxZLRCyO7rK7",
        "name": "Group",
        "title": "Validate/Create Feed and Get Feed entries",
        "type": "logic.group",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Validate/Create Feed and Get Feed entries",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "actions": [
          {
            "unique_name": "definition_activity_020Y4P8X05OVF5NTeHXfBSUWOp7pLDFOMHP",
            "name": "HTTP Request",
            "title": "Get Feeds",
            "type": "web-service.http_request",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "allow_auto_redirect": true,
              "allow_headers_redirect": false,
              "content_type": "application/json",
              "continue_on_error_status_code": false,
              "continue_on_failure": false,
              "display_name": "Get Feeds",
              "method": "GET",
              "relative_url": "/ctia/feed/search",
              "runtime_user": {
                "target_default": true
              },
              "skip_execution": false,
              "target": {
                "override_workflow_target": true,
                "target_id": "definition_target_01K5COU2P4BJ93qEsN20qTZ7JxYaSsM3m36"
              }
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_020Y4P8YGHP7Z3xHZDPcqmMJQt680Jt5ayG",
            "name": "JSONPath Query",
            "title": "Extract Feed Details",
            "type": "corejava.jsonpathquery",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "continue_on_failure": true,
              "display_name": "Extract Feed Details",
              "input_json": "$activity.definition_activity_020Y4P8X05OVF5NTeHXfBSUWOp7pLDFOMHP.output.response_body$",
              "jsonpath_queries": [
                {
                  "jsonpath_query": "$[?(@.title == '$workflow.definition_workflow_020Y4P7XXR77L4xZN5IOho9col6EBkt0COs.input.variable_workflow_020Y4P7Y84GDP5WLUyBaugzUBfMVu1GlsFy$')]",
                  "jsonpath_query_name": "feed_details",
                  "jsonpath_query_type": "string"
                }
              ],
              "skip_execution": false
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_020Y4P8ZL2LKU2MEnvu2aZJy9rEBgQTa8ks",
            "name": "Condition Block",
            "title": "If Feed exists",
            "type": "logic.if_else",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "If Feed exists",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "blocks": [
              {
                "unique_name": "definition_activity_020Y4P90JFQF21cX0OE6cm8qEJLeK0hzCoL",
                "name": "Condition Branch",
                "title": "No",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": "$activity.definition_activity_020Y4P8YGHP7Z3xHZDPcqmMJQt680Jt5ayG.output.succeeded$",
                    "operator": "eq",
                    "right_operand": false
                  },
                  "continue_on_failure": false,
                  "display_name": "No",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_020Y4P922JRTQ1TQSkHGntlYAA3OajvL2La",
                    "name": "HTTP Request",
                    "title": "Create Feed",
                    "type": "web-service.http_request",
                    "base_type": "activity",
                    "properties": {
                      "action_timeout": 180,
                      "allow_auto_redirect": true,
                      "allow_headers_redirect": false,
                      "body": "{\n    \"indicator_id\": \"$workflow.definition_workflow_020Y4P7XXR77L4xZN5IOho9col6EBkt0COs.local.variable_workflow_020Y4P7Y852EJ5kszSE8231jGZv0XgDdiHX$\",\n    \"type\": \"feed\",\n    \"output\": \"observables\",\n    \"title\": \"$workflow.definition_workflow_020Y4P7XXR77L4xZN5IOho9col6EBkt0COs.input.variable_workflow_020Y4P7Y84GDP5WLUyBaugzUBfMVu1GlsFy$\",\n    \"tlp\": \"amber\",\n    \"lifetime\": {\n      \"start_time\": \"2022-01-01T10:10:00.000Z\"\n    },\n  \"authorized_groups\": [\n      \"$workflow.definition_workflow_020Y4P7XXR77L4xZN5IOho9col6EBkt0COs.local.variable_workflow_020Y4P7Y84UUF7dPuOqsFyCPTmuDWSR2r6D$\"\n    ],\n    \"feed_type\": \"indicator\"\n  }",
                      "content_type": "application/json",
                      "continue_on_error_status_code": false,
                      "continue_on_failure": false,
                      "display_name": "Create Feed",
                      "method": "POST",
                      "relative_url": "/ctia/feed",
                      "runtime_user": {
                        "target_default": true
                      },
                      "skip_execution": false,
                      "target": {
                        "override_workflow_target": true,
                        "target_id": "definition_target_01K5COU2P4BJ93qEsN20qTZ7JxYaSsM3m36"
                      }
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_020Y63H01D4XK3jJzjRT32x62TC5iqc4nmG",
                    "name": "Set Variables",
                    "title": "Update Feed Details Variable",
                    "type": "core.set_multiple_variables",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Update Feed Details Variable",
                      "skip_execution": false,
                      "variables_to_update": [
                        {
                          "variable_to_update": "$workflow.definition_workflow_020Y4P7XXR77L4xZN5IOho9col6EBkt0COs.local.variable_workflow_020Y62SMOXCHA4qBtbzlO4QyDznerSuDbpB$",
                          "variable_value_new": "$activity.definition_activity_020Y4P922JRTQ1TQSkHGntlYAA3OajvL2La.output.response_body$"
                        }
                      ]
                    },
                    "object_type": "definition_activity"
                  }
                ]
              },
              {
                "unique_name": "definition_activity_021A7A5VG1YHW20Dr3Pr5cuyAfI7ToSzBW4",
                "name": "Condition Branch",
                "title": "Yes",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": "$activity.definition_activity_020Y4P8YGHP7Z3xHZDPcqmMJQt680Jt5ayG.output.succeeded$",
                    "operator": "eq",
                    "right_operand": true
                  },
                  "continue_on_failure": false,
                  "display_name": "Yes",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_020Y62YRXCDJ61c5vp7cubeNArDwSM3p1Fb",
                    "name": "Set Variables",
                    "title": "Update Feed Details Variable",
                    "type": "core.set_multiple_variables",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Update Feed Details Variable",
                      "skip_execution": false,
                      "variables_to_update": [
                        {
                          "variable_to_update": "$workflow.definition_workflow_020Y4P7XXR77L4xZN5IOho9col6EBkt0COs.local.variable_workflow_020Y62SMOXCHA4qBtbzlO4QyDznerSuDbpB$",
                          "variable_value_new": "$activity.definition_activity_020Y4P8YGHP7Z3xHZDPcqmMJQt680Jt5ayG.output.jsonpath_queries.feed_details$"
                        }
                      ]
                    },
                    "object_type": "definition_activity"
                  }
                ]
              }
            ]
          },
          {
            "unique_name": "definition_activity_020Y62DBQ4B983K2Pc45C0zIyollrGKAyAR",
            "name": "SecureX - Get feed entries",
            "title": "SecureX - Get feed entries",
            "type": "workflow.sub_workflow",
            "base_type": "subworkflow",
            "properties": {
              "continue_on_failure": false,
              "display_name": "SecureX - Get feed entries",
              "input": {
                "variable_workflow_020Y5SEMPXZ3E6xhsVhF4rZ125Cmiiyc0Lo": "$workflow.definition_workflow_020Y4P7XXR77L4xZN5IOho9col6EBkt0COs.local.variable_workflow_020Y62SMOXCHA4qBtbzlO4QyDznerSuDbpB$"
              },
              "runtime_user": {
                "target_default": true
              },
              "skip_execution": false,
              "target": {
                "execute_on_this_target_group": true,
                "target_group_id": "target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH"
              },
              "workflow_id": "definition_workflow_020Y5S395W5234aoEemc0d9xgaYlfWvI0DX",
              "workflow_name": "SecureX - Get feed entries"
            },
            "object_type": "definition_activity"
          }
        ]
      },
      {
        "unique_name": "definition_activity_020Y6CBHU1A3Z1CK3ixgCojwXxFghOYl2GJ",
        "name": "Group",
        "title": "Get Umbrella Destination Entries",
        "type": "logic.group",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Get Umbrella Destination Entries",
          "skip_execution": false
        },
        "object_type": "definition_activity",
        "actions": [
          {
            "unique_name": "definition_activity_020Y6DCQ6933A0m8QEY6uw49inFzt6V7Ggi",
            "name": "Umbrella - Get Token",
            "title": "Umbrella - Get Token",
            "type": "workflow.atomic_workflow",
            "base_type": "subworkflow",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Umbrella - Get Token",
              "runtime_user": {
                "override_target_runtime_user": true,
                "runtime_user_id": "definition_runtime_user_020Y7O4RBIWDT5qX2pQPiOEBrnC4kQWlDjP",
                "runtime_user_type": "runtime_user.web-service_basic_credentials"
              },
              "skip_execution": false,
              "target": {
                "override_workflow_target": true,
                "target_id": "definition_target_0204HN8J4KYCU4VBiEY3lg1plOFKGMDe57j",
                "target_type": "web-service.endpoint"
              },
              "workflow_id": "definition_workflow_0204GWQHPXIXZ3GOjMdVOzF9cezREUY0hX6",
              "workflow_name": "Umbrella - Get Token"
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_020Y6DZIZXXW07ONEIw2b8OUSSfI5WqGCJq",
            "name": "Umbrella - Get Destination Lists",
            "title": "Umbrella - Get Destination Lists",
            "type": "workflow.atomic_workflow",
            "base_type": "subworkflow",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Umbrella - Get Destination Lists",
              "input": {
                "variable_workflow_0204H7MGM5FSY1d7OSN32O1DVNT2EUQrxo7": "$activity.definition_activity_020Y6DCQ6933A0m8QEY6uw49inFzt6V7Ggi.output.variable_workflow_0204GWQI4N5MD0Huemm22PAqecLmG6flBMg$",
                "variable_workflow_0204I5ELJVUH31KXIz3W1i1uH0S8cz4gpCo": 100,
                "variable_workflow_0204I5KXFMCDX3T0CTvgwsaljllQIvQSL8H": 1
              },
              "runtime_user": {
                "target_default": true
              },
              "skip_execution": false,
              "target": {
                "override_workflow_target_group_criteria": true,
                "target_group": {
                  "run_on_all_targets": false,
                  "use_criteria": {
                    "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                    "conditions": [
                      {
                        "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                        "operator": "eq",
                        "right_operand": "Umbrella API v2"
                      }
                    ]
                  }
                }
              },
              "workflow_id": "definition_workflow_0204H2P2WWMIP4Gk094MfmJxPnILJcWt0DX",
              "workflow_name": "Umbrella - Get Destination Lists"
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_020Y6EYZKWLK11EWBLL64KKOGrQkI3qRMyA",
            "name": "JSONPath Query",
            "title": "Extract Destination ID",
            "type": "corejava.jsonpathquery",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "continue_on_failure": false,
              "display_name": "Extract Destination ID",
              "input_json": "$activity.definition_activity_020Y6DZIZXXW07ONEIw2b8OUSSfI5WqGCJq.output.variable_workflow_0204H2P37WV7X5iEKhskBZIQYNDch4ubkMv$",
              "jsonpath_queries": [
                {
                  "jsonpath_query": "$.data[?(@.name == \"$workflow.definition_workflow_020Y4P7XXR77L4xZN5IOho9col6EBkt0COs.local.variable_workflow_020Y6CTDZ1O1G6fiIcDFXIDEgMQfe49m8Bm$\")].id",
                  "jsonpath_query_name": "destinationListId",
                  "jsonpath_query_type": "integer"
                }
              ],
              "skip_execution": false
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_020Y6JDVA4OW12YFvGoIMOZLr3rrKdqVBx8",
            "name": "HTTP Request",
            "title": "Umbrella - Get Total Destinations",
            "type": "web-service.http_request",
            "base_type": "activity",
            "properties": {
              "accept": "application/json",
              "action_timeout": 180,
              "allow_auto_redirect": true,
              "allow_headers_redirect": false,
              "content_type": "application/json",
              "continue_on_error_status_code": true,
              "continue_on_failure": false,
              "custom_headers": [
                {
                  "name": "Authorization",
                  "value": "Bearer $activity.definition_activity_020Y6DCQ6933A0m8QEY6uw49inFzt6V7Ggi.output.variable_workflow_0204GWQI4N5MD0Huemm22PAqecLmG6flBMg$"
                }
              ],
              "display_name": "Umbrella - Get Total Destinations",
              "method": "GET",
              "relative_url": "policies/v2/destinationlists/$activity.definition_activity_020Y6EYZKWLK11EWBLL64KKOGrQkI3qRMyA.output.jsonpath_queries.destinationListId$/destinations?page=1000",
              "runtime_user": {
                "target_default": true
              },
              "skip_execution": false,
              "target": {
                "override_workflow_target_group_criteria": true,
                "target_group": {
                  "run_on_all_targets": false,
                  "use_criteria": {
                    "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                    "conditions": [
                      {
                        "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                        "operator": "eq",
                        "right_operand": "Umbrella API v2"
                      }
                    ]
                  }
                }
              }
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_020Y6NQCR4B6N6b10WIBmqOxDo4YKqSjpGs",
            "name": "JSONPath Query",
            "title": "Extract Total Destinations",
            "type": "corejava.jsonpathquery",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "continue_on_failure": false,
              "display_name": "Extract Total Destinations",
              "input_json": "$activity.definition_activity_020Y6JDVA4OW12YFvGoIMOZLr3rrKdqVBx8.output.response_body$",
              "jsonpath_queries": [
                {
                  "jsonpath_query": "$.meta.total",
                  "jsonpath_query_name": "destinations_total",
                  "jsonpath_query_type": "string"
                }
              ],
              "skip_execution": false
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_020Y6Q3VKUE4T7dxMmNg1FWSjxG9YQEuolW",
            "name": "Execute Python Script",
            "title": "Get totals",
            "type": "python3.script",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "continue_on_failure": false,
              "description": "Get total destinations count and total pages count",
              "display_name": "Get totals",
              "script": "import sys,json\n\nbody = json.loads(sys.argv[1])\n\ntotal_entries = int(body['meta']['total'])\ntotal_pages = total_entries // 100 + 1\n",
              "script_arguments": [
                "$activity.definition_activity_020Y6JDVA4OW12YFvGoIMOZLr3rrKdqVBx8.output.response_body$"
              ],
              "script_queries": [
                {
                  "script_query": "total_entries",
                  "script_query_name": "total_entries",
                  "script_query_type": "integer"
                },
                {
                  "script_query": "total_pages",
                  "script_query_name": "total_pages",
                  "script_query_type": "integer"
                }
              ],
              "skip_execution": false
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_020Y6XUJHJ54L58HoAxo2b3SOEeKIZSgnzN",
            "name": "While Loop",
            "title": "While did not reach last page",
            "type": "logic.while",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "While did not reach last page",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "blocks": [
              {
                "unique_name": "definition_activity_020Y6XUJS3Q564YUtTS8aKqUvNms6z3a24y",
                "name": "Condition Branch",
                "title": "Current page \u003c= Total Pages",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": "$workflow.definition_workflow_020Y4P7XXR77L4xZN5IOho9col6EBkt0COs.local.variable_workflow_020Y6Y8U99CR34isCj0O9GlVDbig83Jdv2f$",
                    "operator": "lte",
                    "right_operand": "$activity.definition_activity_020Y6Q3VKUE4T7dxMmNg1FWSjxG9YQEuolW.output.script_queries.total_pages$"
                  },
                  "continue_on_failure": false,
                  "display_name": "Current page \u003c= Total Pages",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_020Y706I6IMP24ReMINKuZ3xIPDFvffRXzo",
                    "name": "Umbrella - Get Destination List Entries",
                    "title": "Umbrella - Get Destination List Entries",
                    "type": "workflow.atomic_workflow",
                    "base_type": "subworkflow",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Umbrella - Get Destination List Entries",
                      "input": {
                        "variable_workflow_0204H5ZVW8K0D7aTjwOHW6rsVclvSbcEfJm": 100,
                        "variable_workflow_0204H5ZVW8UA244x87FF7nt24V88qUv9rzm": "$activity.definition_activity_020Y6EYZKWLK11EWBLL64KKOGrQkI3qRMyA.output.jsonpath_queries.destinationListId$",
                        "variable_workflow_0204H5ZVW9B491YLJ54LXxKVervOv3PuFFP": "$workflow.definition_workflow_020Y4P7XXR77L4xZN5IOho9col6EBkt0COs.local.variable_workflow_020Y6Y8U99CR34isCj0O9GlVDbig83Jdv2f$",
                        "variable_workflow_0204H85SIW83M78rqHjgHQo2x48I8Zpaeez": "$activity.definition_activity_020Y6DCQ6933A0m8QEY6uw49inFzt6V7Ggi.output.variable_workflow_0204GWQI4N5MD0Huemm22PAqecLmG6flBMg$"
                      },
                      "runtime_user": {
                        "target_default": true
                      },
                      "skip_execution": false,
                      "target": {
                        "override_workflow_target_group_criteria": true,
                        "target_group": {
                          "run_on_all_targets": false,
                          "use_criteria": {
                            "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                            "conditions": [
                              {
                                "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                                "operator": "eq",
                                "right_operand": "Umbrella API v2"
                              }
                            ]
                          }
                        }
                      },
                      "workflow_id": "definition_workflow_0204H5ZVN0ZN256UTZ86ZRCflW6pqrVR62m",
                      "workflow_name": "Umbrella - Get Destination List Entries"
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_020Y73HEHBUGC0E4dwrMcqgGwTzrJUD9b3X",
                    "name": "Execute Python Script",
                    "title": "Append Destinations",
                    "type": "python3.script",
                    "base_type": "activity",
                    "properties": {
                      "action_timeout": 180,
                      "continue_on_failure": false,
                      "description": "Append Destinations from current page to full list",
                      "display_name": "Append Destinations",
                      "script": "import sys,json\n\ndsts_full_list = json.loads(sys.argv[2])\n\numbrella_dsts = json.loads(sys.argv[1])\n#securex_entries = json.loads(sys.argv[2])\n#securex_entries = sys.argv[2]\n\nfor dst in umbrella_dsts[\"data\"]:\n#    if dst[\"destination\"] not in securex_entries:\n#        dsts_to_add.append({\"observable\":dst[\"destination\"]})\n    dsts_full_list['destinations'].append(dst[\"destination\"])\n\noutput = json.dumps(dsts_full_list)",
                      "script_arguments": [
                        "$activity.definition_activity_020Y706I6IMP24ReMINKuZ3xIPDFvffRXzo.output.variable_workflow_0204H5ZVW92084NZUJtoVJXPlPD7KpEcX8K$",
                        "$workflow.definition_workflow_020Y4P7XXR77L4xZN5IOho9col6EBkt0COs.local.variable_workflow_020ZVPN3NK6WN7VkLCbOhjc8T8vcbHGAxyr$"
                      ],
                      "script_queries": [
                        {
                          "script_query": "output",
                          "script_query_name": "dsts_full_list",
                          "script_query_type": "string"
                        }
                      ],
                      "skip_execution": false
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_020Y8WJTXRZ7T34XYkwaI0paKNm22wj4gtb",
                    "name": "Set Variables",
                    "title": "Update Umbrella Full List Variable",
                    "type": "core.set_multiple_variables",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Update Umbrella Full List Variable",
                      "skip_execution": false,
                      "variables_to_update": [
                        {
                          "variable_to_update": "$workflow.definition_workflow_020Y4P7XXR77L4xZN5IOho9col6EBkt0COs.local.variable_workflow_020ZVPN3NK6WN7VkLCbOhjc8T8vcbHGAxyr$",
                          "variable_value_new": "$activity.definition_activity_020Y73HEHBUGC0E4dwrMcqgGwTzrJUD9b3X.output.script_queries.dsts_full_list$"
                        }
                      ]
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_020Y7RVKWRD1V7iKOL8VQ606iprnk3QYhmW",
                    "name": "Set Variables",
                    "title": "Increment Inetator by 1",
                    "type": "core.set_multiple_variables",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Increment Inetator by 1",
                      "skip_execution": false,
                      "variables_to_update": [
                        {
                          "variable_to_update": "$workflow.definition_workflow_020Y4P7XXR77L4xZN5IOho9col6EBkt0COs.local.variable_workflow_020Y6Y8U99CR34isCj0O9GlVDbig83Jdv2f$",
                          "variable_value_new": "$workflow.definition_workflow_020Y4P7XXR77L4xZN5IOho9col6EBkt0COs.local.variable_workflow_020Y6Y8U99CR34isCj0O9GlVDbig83Jdv2f$+1"
                        }
                      ]
                    },
                    "object_type": "definition_activity"
                  }
                ]
              }
            ]
          }
        ]
      },
      {
        "unique_name": "definition_activity_020ZVJSKRAWNK5ttCdAC6u1yIBqzcxuiM8K",
        "name": "Execute Python Script",
        "title": "Execute Python Script",
        "type": "python3.script",
        "base_type": "activity",
        "properties": {
          "action_timeout": 180,
          "continue_on_failure": false,
          "display_name": "Execute Python Script",
          "script": "import sys, json\n\nfeed_entries = json.loads(sys.argv[1])\numbrella_dsts = json.loads(sys.argv[2])\n\nfeed_values = []\nfor entry in feed_entries[\"observables\"]:\n    feed_values.append(entry[\"value\"])\n\n#umbrella_values = []\n#for entry in umbrella_dsts[\"destinations\"]:\n#    umbrella_values.append(entry[\"observable\"])\numbrella_values = umbrella_dsts[\"destinations\"]\n\nfeed_set = set(feed_values)\n#add_to_feed = [{\"observable\":dst} for dst in umbrella_values if dst not in s1]\numbrella_set = set(umbrella_values)\n#remove_from_feed = [{\"observable\":obs} for obs in feed_values if obs not in s2]\nadd_to_feed = list(umbrella_set.difference(feed_set))\nremove_from_feed = list(feed_set.difference(umbrella_set))\n\nadd_output = json.dumps([{\"destination\": x} for x in add_to_feed])\nremove_output = json.dumps([{\"observable\": x} for x in remove_from_feed])",
          "script_arguments": [
            "$activity.definition_activity_020Y62DBQ4B983K2Pc45C0zIyollrGKAyAR.output.variable_workflow_020Y5SHUEGY0P2AGgu2eIpxxpLZNxth4P1I$",
            "$workflow.definition_workflow_020Y4P7XXR77L4xZN5IOho9col6EBkt0COs.local.variable_workflow_020ZVPN3NK6WN7VkLCbOhjc8T8vcbHGAxyr$"
          ],
          "script_queries": [
            {
              "script_query": "add_output",
              "script_query_name": "add_output",
              "script_query_type": "string"
            },
            {
              "script_query": "remove_output",
              "script_query_name": "remove_output",
              "script_query_type": "string"
            }
          ],
          "skip_execution": false
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_020Y4P97HW4UC7MIAGeSww1mUQgA5uon2GR",
        "name": "Read Table from JSON",
        "title": "Read Destinations to Add to the Feed",
        "type": "corejava.read_table_from_json",
        "base_type": "activity",
        "properties": {
          "action_timeout": 180,
          "continue_on_failure": false,
          "display_name": "Read Destinations to Add to the Feed",
          "input_json": "$activity.definition_activity_020ZVJSKRAWNK5ttCdAC6u1yIBqzcxuiM8K.output.script_queries.add_output$",
          "jsonpath_query": "$.",
          "persist_output": false,
          "populate_columns": false,
          "skip_execution": false,
          "table_columns": [
            {
              "column_name": "destination",
              "column_type": "string"
            }
          ]
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_020Y4P999GB7363Y3TUfFErEiHndtOELY4L",
        "name": "For Each",
        "title": "For Each Destination",
        "type": "logic.for_each",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": true,
          "display_name": "For Each Destination",
          "skip_execution": false,
          "source_array": "$activity.definition_activity_020Y4P97HW4UC7MIAGeSww1mUQgA5uon2GR.output.read_table_from_json$"
        },
        "object_type": "definition_activity",
        "actions": [
          {
            "unique_name": "definition_activity_020Y4P9BXZNBS5AIAXgGxAEKUL6BBKCuTaa",
            "name": "Create Judgement JSON",
            "title": "Create Judgement JSON",
            "type": "workflow.sub_workflow",
            "base_type": "subworkflow",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Create Judgement JSON",
              "input": {
                "variable_workflow_0209O0384IBIP7FLf8uNmcBdz2dAHDxFKEC": "$activity.definition_activity_020Y4P8ELY2IO3DRuNgHvs4DhUicUqZlk5B.output.jsonpath_queries.group_id$",
                "variable_workflow_0209O0384IPGL5VYnn2tELLWJkPXfKpbdmF": "OpenPhish",
                "variable_workflow_0209O0384IXUQ7WwqdPNR1Zna8LRAFGdU7s": "Medium",
                "variable_workflow_0209O0384J4RY1pUk1w4FxSOBSUFWIlJUoj": "Malicious",
                "variable_workflow_0209O0384JBJL1zGw1LokdAPOSFqmINazjY": "high",
                "variable_workflow_0209O0384JIHT4rTbO3zWHGTKaAyePU8nZr": "$activity.definition_activity_020Y4P999GB7363Y3TUfFErEiHndtOELY4L.input.source_array[@].destination$",
                "variable_workflow_0209O0384JQEL6YwGc04mAwjV6eXbmvkTOm": "url",
                "variable_workflow_0209O0384JY6T1BgZioCCeLZ9HfuaP18HGa": "amber",
                "variable_workflow_0209O0384KP9D3v8WbEmUK4xhOant7WOfS3": 3650,
                "variable_workflow_0209O0384KW391cs7RmT8lulazuO19snQTX": 100
              },
              "runtime_user": {
                "target_default": true
              },
              "skip_execution": false,
              "target": {
                "execute_on_this_target_group": false,
                "no_target": false,
                "override_workflow_target": false,
                "override_workflow_target_group_criteria": false,
                "use_workflow_target_group": false
              },
              "workflow_id": "definition_workflow_0209O037OHHXE4cxu8dttkABb9AJa3g6tNY",
              "workflow_name": "Create Judgement"
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_020Y4P9DTCUTM0Ksor5hddfKIAqzf9pFh9m",
            "name": "HTTP Request",
            "title": "Post New Judgement",
            "type": "web-service.http_request",
            "base_type": "activity",
            "properties": {
              "accept": "application/json",
              "action_timeout": 180,
              "allow_auto_redirect": true,
              "allow_headers_redirect": false,
              "body": "$activity.definition_activity_020Y4P9BXZNBS5AIAXgGxAEKUL6BBKCuTaa.output.variable_workflow_0209O0384K9L92OSO0hqZtY7OBLiWJhjrsc$",
              "content_type": "application/json",
              "continue_on_error_status_code": false,
              "continue_on_failure": false,
              "display_name": "Post New Judgement",
              "method": "POST",
              "relative_url": "/ctia/judgement",
              "runtime_user": {
                "target_default": true
              },
              "skip_execution": false,
              "target": {
                "override_workflow_target": true,
                "target_id": "definition_target_01K5COU2P4BJ93qEsN20qTZ7JxYaSsM3m36"
              }
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_020Y4P9FKDB484w0KGSNicrFvUHxBOTEhzI",
            "name": "JSONPath Query",
            "title": "Get Judgement ID",
            "type": "corejava.jsonpathquery",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "continue_on_failure": false,
              "display_name": "Get Judgement ID",
              "input_json": "$activity.definition_activity_020Y4P9DTCUTM0Ksor5hddfKIAqzf9pFh9m.output.response_body$",
              "jsonpath_queries": [
                {
                  "jsonpath_query": "$.id",
                  "jsonpath_query_name": "id",
                  "jsonpath_query_type": "string"
                }
              ],
              "skip_execution": false
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_020Y4P9GZWIQM1TFh9o56wPNWtrOr7L34Xy",
            "name": "HTTP Request",
            "title": "Link to Indicator",
            "type": "web-service.http_request",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "allow_auto_redirect": true,
              "allow_headers_redirect": false,
              "body": "{\n  \"source_ref\":\"$activity.definition_activity_020Y4P9FKDB484w0KGSNicrFvUHxBOTEhzI.output.jsonpath_queries.id$\",\n  \"target_ref\":\"$workflow.definition_workflow_020Y4P7XXR77L4xZN5IOho9col6EBkt0COs.local.variable_workflow_020Y4P7Y852EJ5kszSE8231jGZv0XgDdiHX$\",\n  \"type\":\"relationship\",\n  \"relationship_type\":\"element-of\"\n}",
              "content_type": "application/json",
              "continue_on_error_status_code": false,
              "continue_on_failure": false,
              "display_name": "Link to Indicator",
              "method": "POST",
              "relative_url": "/ctia/relationship",
              "runtime_user": {
                "target_default": true
              },
              "skip_execution": false,
              "target": {
                "override_workflow_target": true,
                "target_id": "definition_target_01K5COU2P4BJ93qEsN20qTZ7JxYaSsM3m36"
              }
            },
            "object_type": "definition_activity"
          }
        ]
      },
      {
        "unique_name": "definition_activity_020ZXSY89PIMH0i3SMW8y9FhJE2dWM6oB5K",
        "name": "Read Table from JSON",
        "title": "Read Observables to remove from Feed",
        "type": "corejava.read_table_from_json",
        "base_type": "activity",
        "properties": {
          "action_timeout": 180,
          "continue_on_failure": false,
          "display_name": "Read Observables to remove from Feed",
          "input_json": "$activity.definition_activity_020ZVJSKRAWNK5ttCdAC6u1yIBqzcxuiM8K.output.script_queries.remove_output$",
          "jsonpath_query": "$.",
          "persist_output": false,
          "populate_columns": false,
          "skip_execution": false,
          "table_columns": [
            {
              "column_name": "observable",
              "column_type": "string"
            }
          ]
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_020ZXTM89RRRJ7IcLrd8w4cv8WU86e3HSdz",
        "name": "For Each",
        "title": "For Each Observable",
        "type": "logic.for_each",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": true,
          "display_name": "For Each Observable",
          "skip_execution": false,
          "source_array": "$activity.definition_activity_020ZXSY89PIMH0i3SMW8y9FhJE2dWM6oB5K.output.read_table_from_json$"
        },
        "object_type": "definition_activity",
        "actions": [
          {
            "unique_name": "definition_activity_0210TNCWUMFV304xdBEwoKXuixj17p2Mgvv",
            "name": "HTTP Request",
            "title": "Fetch Judgements",
            "type": "web-service.http_request",
            "base_type": "activity",
            "properties": {
              "accept": "application/json",
              "action_timeout": 180,
              "allow_auto_redirect": true,
              "allow_headers_redirect": false,
              "body": "{\n  \"query\": \"query Judgements ($query: String, $first: Int, $last: Int, $before: String, $after: String, $sortColumnName: JudgementOrderField!, $sortDirection: OrderDirection!) {\\n  judgements(query: $query, first: $first, last: $last, before: $before, after: $after, orderBy:{field: $sortColumnName, direction: $sortDirection }) {\\n      edges {\\n        node {\\n            id\\n            type\\n            disposition\\n            reason\\n            reason_uri\\n            source\\n            source_uri\\n            severity\\n            confidence\\n            tlp\\n            priority\\n            valid_time {\\n              start_time\\n              end_time\\n            }\\n            observable {\\n              value\\n              type\\n            }\\n          }\\n          cursor\\n        }\\n        totalCount\\n        pageInfo {\\n          hasNextPage\\n          hasPreviousPage\\n          startCursor\\n          endCursor\\n        }\\n      }\\n    }\",\n  \"variables\": {\n    \"query\": \"observable.value:\\\"$activity.definition_activity_020ZXTM89RRRJ7IcLrd8w4cv8WU86e3HSdz.input.source_array[@].observable$\\\"\",\n    \"first\": 100,\n    \"last\": null,\n    \"after\": null,\n    \"before\": null,\n    \"sortColumnName\": \"VALID_TIME_START_TIME\",\n    \"sortDirection\": \"desc\"\n  }\n}",
              "content_type": "application/json",
              "continue_on_error_status_code": false,
              "continue_on_failure": false,
              "display_name": "Fetch Judgements",
              "method": "POST",
              "relative_url": "/ctia/graphql",
              "runtime_user": {
                "target_default": true
              },
              "skip_execution": false,
              "target": {
                "override_workflow_target_group_criteria": true,
                "target_group": {
                  "run_on_all_targets": false,
                  "use_criteria": {
                    "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                    "conditions": [
                      {
                        "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                        "operator": "eq",
                        "right_operand": "Private_CTIA_Target"
                      }
                    ]
                  }
                }
              }
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_02100ZXS49YDA7hBorTI1drAJ2wvSeY6o3L",
            "name": "Read Table from JSON",
            "title": "Extract Judgement ID String",
            "type": "corejava.read_table_from_json",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "continue_on_failure": false,
              "display_name": "Extract Judgement ID String",
              "input_json": "$activity.definition_activity_0210TNCWUMFV304xdBEwoKXuixj17p2Mgvv.output.response_body$",
              "jsonpath_query": "$.data.judgements.edges[*].node",
              "persist_output": false,
              "populate_columns": false,
              "skip_execution": false,
              "table_columns": [
                {
                  "column_name": "id",
                  "column_type": "string"
                }
              ]
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_0210U5VV4HB6C4WoPlRaLn2RnUqGHGGbz28",
            "name": "For Each",
            "title": "For Each Judgement ID",
            "type": "logic.for_each",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "For Each Judgement ID",
              "skip_execution": false,
              "source_array": "$activity.definition_activity_02100ZXS49YDA7hBorTI1drAJ2wvSeY6o3L.output.read_table_from_json$"
            },
            "object_type": "definition_activity",
            "actions": [
              {
                "unique_name": "definition_activity_0210U8S18SY2O5WR2wFH9EIta7OmyHiQms6",
                "name": "Match Regex",
                "title": "Extract Judgement ID",
                "type": "core.matchregex",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Extract Judgement ID",
                  "input_regex": "judgement-.+",
                  "input_string": "$activity.definition_activity_0210U5VV4HB6C4WoPlRaLn2RnUqGHGGbz28.input.source_array[@].id$",
                  "match_case": false,
                  "skip_execution": false
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_0210U7Y9VY0UY3HIqpcMBRGVBWAEBLFMYCG",
                "name": "HTTP Request",
                "title": "Delete Judgement by ID",
                "type": "web-service.http_request",
                "base_type": "activity",
                "properties": {
                  "accept": "applocation/json",
                  "action_timeout": 180,
                  "allow_auto_redirect": true,
                  "allow_headers_redirect": false,
                  "content_type": "application/json",
                  "continue_on_error_status_code": false,
                  "continue_on_failure": false,
                  "display_name": "Delete Judgement by ID",
                  "method": "DELETE",
                  "relative_url": "/ctia/judgement/$activity.definition_activity_0210U8S18SY2O5WR2wFH9EIta7OmyHiQms6.output.matching_strings[0]$",
                  "runtime_user": {
                    "target_default": true
                  },
                  "skip_execution": false,
                  "target": {
                    "override_workflow_target_group_criteria": true,
                    "target_group": {
                      "run_on_all_targets": false,
                      "use_criteria": {
                        "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                        "conditions": [
                          {
                            "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                            "operator": "eq",
                            "right_operand": "Private_CTIA_Target"
                          }
                        ]
                      }
                    }
                  }
                },
                "object_type": "definition_activity"
              }
            ]
          }
        ]
      }
    ],
    "categories": [
      "category_1BMfMXSnJMyt5Ihqi7rWJr5N8cf"
    ]
  },
  "targets": {
    "definition_target_01K5COU2P4BJ93qEsN20qTZ7JxYaSsM3m36": {
      "unique_name": "definition_target_01K5COU2P4BJ93qEsN20qTZ7JxYaSsM3m36",
      "name": "Private_CTIA_Target",
      "title": "Private_CTIA_Target",
      "type": "web-service.endpoint",
      "base_type": "target",
      "object_type": "definition_target",
      "properties": {
        "default_runtime_user_id": "definition_runtime_user_01WQ21HE86QNT5Bu5rze9UYYPiWx8wAKyQX",
        "description": "Private_CTIA_Target",
        "disable_certificate_validation": false,
        "display_name": "Private_CTIA_Target",
        "host": "private.intel.amp.cisco.com",
        "no_runtime_user": false,
        "protocol": "https"
      }
    },
    "definition_target_0204HN8J4KYCU4VBiEY3lg1plOFKGMDe57j": {
      "unique_name": "definition_target_0204HN8J4KYCU4VBiEY3lg1plOFKGMDe57j",
      "name": "Umbrella API v2 OAuth2",
      "title": "Umbrella API v2 OAuth2",
      "type": "web-service.endpoint",
      "base_type": "target",
      "object_type": "definition_target",
      "properties": {
        "default_runtime_user_id": "definition_runtime_user_0204HN7WP5H305j0Q9IkHfv2inNmUf11ojx",
        "disable_certificate_validation": false,
        "display_name": "Umbrella API v2 OAuth2",
        "host": "api.umbrella.com",
        "ignore_proxy": false,
        "no_runtime_user": false,
        "protocol": "https"
      }
    }
  },
  "runtime_users": {
    "definition_runtime_user_01WQ21HE86QNT5Bu5rze9UYYPiWx8wAKyQX": {
      "unique_name": "definition_runtime_user_01WQ21HE86QNT5Bu5rze9UYYPiWx8wAKyQX",
      "name": "SecureX Token",
      "title": "SecureX Token",
      "type": "runtime_user.oauth_integration",
      "base_type": "runtime_user",
      "object_type": "definition_runtime_user",
      "properties": {
        "display_name": "SecureX Token"
      }
    },
    "definition_runtime_user_0204HN7WP5H305j0Q9IkHfv2inNmUf11ojx": {
      "unique_name": "definition_runtime_user_0204HN7WP5H305j0Q9IkHfv2inNmUf11ojx",
      "name": "Umbrella v2",
      "title": "Umbrella v2",
      "type": "runtime_user.web-service_basic_credentials",
      "base_type": "runtime_user",
      "object_type": "definition_runtime_user",
      "properties": {
        "auth_option": "Basic",
        "basic_password": "*****",
        "basic_username": "63418cfd9b4b42f5876d35c80baac4d6",
        "display_name": "Umbrella v2"
      }
    },
    "definition_runtime_user_020Y7O4RBIWDT5qX2pQPiOEBrnC4kQWlDjP": {
      "unique_name": "definition_runtime_user_020Y7O4RBIWDT5qX2pQPiOEBrnC4kQWlDjP",
      "name": "Umbrella v2 DNE Org",
      "title": "Umbrella v2 DNE Org",
      "type": "runtime_user.web-service_basic_credentials",
      "base_type": "runtime_user",
      "object_type": "definition_runtime_user",
      "properties": {
        "auth_option": "Basic",
        "basic_password": "*****",
        "basic_username": "c6ca7e2954cc4dd38a71ce11e0fe0398",
        "description": "For OpenPhish Dst List test",
        "display_name": "Umbrella v2 DNE Org"
      }
    }
  },
  "target_groups": {
    "target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH": {
      "unique_name": "target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH",
      "name": "Default TargetGroup",
      "title": "Default TargetGroup",
      "type": "generic.target_group",
      "base_type": "target_group",
      "version": "1.0.0",
      "targets": [
        {
          "data_target_type": "web-service.endpoint",
          "view_target_type": "web-service.endpoint",
          "include_all_targets": true
        },
        {
          "data_target_type": "email.smtp_endpoint",
          "view_target_type": "email.smtp_endpoint",
          "include_all_targets": true
        }
      ],
      "object_type": "target_group"
    }
  },
  "table_types": {
    "tabletype_01N76TJTB7W9W2xVeTE6lQJYbRC7EkZJ4z8": {
      "unique_name": "tabletype_01N76TJTB7W9W2xVeTE6lQJYbRC7EkZJ4z8",
      "data_type": "datatype.tabletype",
      "display_name": "String Array",
      "columns": [
        {
          "name": "item",
          "title": "item",
          "type": "string"
        }
      ],
      "base_type": "datatype",
      "object_type": "tabletype"
    }
  },
  "subworkflows": [
    {
      "workflow": {
        "unique_name": "definition_workflow_020Y5S395W5234aoEemc0d9xgaYlfWvI0DX",
        "name": "SecureX - Get feed entries",
        "title": "SecureX - Get feed entries",
        "type": "generic.workflow",
        "base_type": "workflow",
        "variables": [
          {
            "schema_id": "datatype.string",
            "properties": {
              "value": "",
              "scope": "output",
              "name": "Feed Entries",
              "type": "datatype.string",
              "is_required": false,
              "is_invisible": false
            },
            "unique_name": "variable_workflow_020Y5SHUEGY0P2AGgu2eIpxxpLZNxth4P1I",
            "object_type": "variable_workflow"
          },
          {
            "schema_id": "datatype.string",
            "properties": {
              "value": "",
              "scope": "input",
              "name": "Feed Details",
              "type": "datatype.string",
              "is_required": true,
              "is_invisible": false
            },
            "unique_name": "variable_workflow_020Y5SEMPXZ3E6xhsVhF4rZ125Cmiiyc0Lo",
            "object_type": "variable_workflow"
          }
        ],
        "properties": {
          "atomic": {
            "is_atomic": false
          },
          "delete_workflow_instance": false,
          "display_name": "SecureX - Get feed entries",
          "runtime_user": {
            "target_default": true
          },
          "target": {
            "execute_on_target_group": true,
            "target_group": {
              "target_group_id": "target_group_01EJ0TQWPQWBD0qiWqClJKj9FOzwiZRfOFH",
              "run_on_all_targets": false,
              "selected_target_types": [
                "web-service.endpoint"
              ],
              "use_criteria": {
                "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                "conditions": [
                  {
                    "operator": "eq",
                    "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                    "right_operand": "CTR_For_Access_Token"
                  }
                ]
              }
            }
          }
        },
        "object_type": "definition_workflow",
        "actions": [
          {
            "unique_name": "definition_activity_020Y5S8TJNJK42ZjgNYAKfmfKvybfq9oHsB",
            "name": "JSONPath Query",
            "title": "Get feed id and secret",
            "type": "corejava.jsonpathquery",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "continue_on_failure": false,
              "display_name": "Get feed id and secret",
              "input_json": "$workflow.definition_workflow_020Y5S395W5234aoEemc0d9xgaYlfWvI0DX.input.variable_workflow_020Y5SEMPXZ3E6xhsVhF4rZ125Cmiiyc0Lo$",
              "jsonpath_queries": [
                {
                  "jsonpath_query": "$.id",
                  "jsonpath_query_name": "feed_id",
                  "jsonpath_query_type": "string"
                },
                {
                  "jsonpath_query": "$.secret",
                  "jsonpath_query_name": "feed_secret",
                  "jsonpath_query_type": "string"
                }
              ],
              "skip_execution": false
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_020Y7EELOYO775QRC5eJXVsoML5HJBUAd8U",
            "name": "Match Regex",
            "title": "Match Regex",
            "type": "core.matchregex",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Match Regex",
              "input_regex": "feed-.+",
              "input_string": "$activity.definition_activity_020Y5S8TJNJK42ZjgNYAKfmfKvybfq9oHsB.output.jsonpath_queries.feed_id$",
              "skip_execution": false
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_020Y5UDKU3AP40RMCW1Rtt7daPsYJw4Wl17",
            "name": "Threat Response - Generate Access Token",
            "title": "Threat Response - Generate Access Token",
            "type": "workflow.atomic_workflow",
            "base_type": "subworkflow",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Threat Response - Generate Access Token",
              "runtime_user": {
                "target_default": true
              },
              "skip_execution": false,
              "target": {
                "override_workflow_target_group_criteria": true,
                "target_group": {
                  "run_on_all_targets": false,
                  "use_criteria": {
                    "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                    "conditions": [
                      {
                        "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                        "operator": "eq",
                        "right_operand": "CTR_For_Access_Token"
                      }
                    ]
                  }
                }
              },
              "workflow_id": "definition_workflow_01PP75S3LTBW4420OZU3rdHWKHFnE6aC7yH",
              "workflow_name": "Threat Response - Generate Access Token"
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_020Y5TM1Z41IA3SsAoZC0aLPnVq44Q65IwZ",
            "name": "HTTP Request",
            "title": "HTTP Request",
            "type": "web-service.http_request",
            "base_type": "activity",
            "properties": {
              "accept": "application/json",
              "action_timeout": 180,
              "allow_auto_redirect": true,
              "allow_headers_redirect": false,
              "content_type": "application/json",
              "continue_on_error_status_code": false,
              "continue_on_failure": false,
              "custom_headers": [
                {
                  "name": "Authorization",
                  "value": "Bearer $activity.definition_activity_020Y5UDKU3AP40RMCW1Rtt7daPsYJw4Wl17.output.variable_workflow_01PP75S3G7CJY6WAQr2IJC7qga2SIoE09gQ$"
                }
              ],
              "display_name": "HTTP Request",
              "method": "GET",
              "relative_url": "/ctia/feed/$activity.definition_activity_020Y7EELOYO775QRC5eJXVsoML5HJBUAd8U.output.matching_strings[0]$/view?s=$activity.definition_activity_020Y5S8TJNJK42ZjgNYAKfmfKvybfq9oHsB.output.jsonpath_queries.feed_secret$",
              "runtime_user": {
                "target_default": true
              },
              "skip_execution": false,
              "target": {
                "override_workflow_target_group_criteria": true,
                "target_group": {
                  "run_on_all_targets": false,
                  "use_criteria": {
                    "choose_target_using_algorithm": "choose_first_with_matching_criteria",
                    "conditions": [
                      {
                        "left_operand": "$targetgroup.web-service endpoint.input.display_name$",
                        "operator": "eq",
                        "right_operand": "Private_CTIA_Target"
                      }
                    ]
                  }
                }
              }
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_020Y5ZJ9AQH7P27IAXjlmFrBM2euCiGtWaX",
            "name": "Set Variables",
            "title": "Set Variables",
            "type": "core.set_multiple_variables",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Set Variables",
              "skip_execution": false,
              "variables_to_update": [
                {
                  "variable_to_update": "$workflow.definition_workflow_020Y5S395W5234aoEemc0d9xgaYlfWvI0DX.output.variable_workflow_020Y5SHUEGY0P2AGgu2eIpxxpLZNxth4P1I$",
                  "variable_value_new": "$activity.definition_activity_020Y5TM1Z41IA3SsAoZC0aLPnVq44Q65IwZ.output.response_body$"
                }
              ]
            },
            "object_type": "definition_activity"
          }
        ],
        "categories": [
          "category_1BMfMXSnJMyt5Ihqi7rWJr5N8cf"
        ]
      },
      "atomic_workflows": [
        "definition_workflow_01PP75S3LTBW4420OZU3rdHWKHFnE6aC7yH"
      ],
      "dependent_workflows": [
        "definition_workflow_01PP75S3LTBW4420OZU3rdHWKHFnE6aC7yH"
      ]
    },
    {
      "workflow": {
        "unique_name": "definition_workflow_0209O037OHHXE4cxu8dttkABb9AJa3g6tNY",
        "name": "Create Judgement",
        "title": "Create Judgement",
        "type": "generic.workflow",
        "base_type": "workflow",
        "variables": [
          {
            "schema_id": "datatype.string",
            "properties": {
              "value": "high",
              "scope": "input",
              "name": "confidence",
              "type": "datatype.string",
              "is_required": false,
              "is_invisible": false
            },
            "unique_name": "variable_workflow_0209O0384JBJL1zGw1LokdAPOSFqmINazjY",
            "object_type": "variable_workflow"
          },
          {
            "schema_id": "datatype.integer",
            "properties": {
              "value": 0,
              "scope": "local",
              "name": "disposition",
              "type": "datatype.integer",
              "is_required": false,
              "is_invisible": false
            },
            "unique_name": "variable_workflow_0209O0384L2HL79MKMU0X77dYaFIFrtDckP",
            "object_type": "variable_workflow"
          },
          {
            "schema_id": "datatype.string",
            "properties": {
              "value": "Medium",
              "scope": "input",
              "name": "severity",
              "type": "datatype.string",
              "is_required": false,
              "is_invisible": false
            },
            "unique_name": "variable_workflow_0209O0384IXUQ7WwqdPNR1Zna8LRAFGdU7s",
            "object_type": "variable_workflow"
          },
          {
            "schema_id": "datatype.string",
            "properties": {
              "value": "",
              "scope": "output",
              "name": "Output JSON",
              "type": "datatype.string",
              "is_required": false,
              "is_invisible": false
            },
            "unique_name": "variable_workflow_0209O0384K9L92OSO0hqZtY7OBLiWJhjrsc",
            "object_type": "variable_workflow"
          },
          {
            "schema_id": "datatype.integer",
            "properties": {
              "value": 0,
              "scope": "input",
              "name": "priority",
              "type": "datatype.integer",
              "is_required": false,
              "is_invisible": false
            },
            "unique_name": "variable_workflow_0209O0384KW391cs7RmT8lulazuO19snQTX",
            "object_type": "variable_workflow"
          },
          {
            "schema_id": "datatype.string",
            "properties": {
              "value": "",
              "scope": "input",
              "name": "source",
              "type": "datatype.string",
              "is_required": true,
              "is_invisible": false
            },
            "unique_name": "variable_workflow_0209O0384IPGL5VYnn2tELLWJkPXfKpbdmF",
            "object_type": "variable_workflow"
          },
          {
            "schema_id": "datatype.string",
            "properties": {
              "value": "",
              "scope": "input",
              "name": "disposition_name",
              "type": "datatype.string",
              "is_required": true,
              "is_invisible": false
            },
            "unique_name": "variable_workflow_0209O0384J4RY1pUk1w4FxSOBSUFWIlJUoj",
            "object_type": "variable_workflow"
          },
          {
            "schema_id": "datatype.string",
            "properties": {
              "value": "",
              "scope": "input",
              "name": "private_intel_group",
              "type": "datatype.string",
              "is_required": true,
              "is_invisible": false
            },
            "unique_name": "variable_workflow_0209O0384IBIP7FLf8uNmcBdz2dAHDxFKEC",
            "object_type": "variable_workflow"
          },
          {
            "schema_id": "datatype.integer",
            "properties": {
              "value": 90,
              "scope": "input",
              "name": "Days Timespan",
              "type": "datatype.integer",
              "is_required": false,
              "is_invisible": false
            },
            "unique_name": "variable_workflow_0209O0384KP9D3v8WbEmUK4xhOant7WOfS3",
            "object_type": "variable_workflow"
          },
          {
            "schema_id": "datatype.string",
            "properties": {
              "value": "",
              "scope": "input",
              "name": "observable_type",
              "type": "datatype.string",
              "is_required": true,
              "is_invisible": false
            },
            "unique_name": "variable_workflow_0209O0384JQEL6YwGc04mAwjV6eXbmvkTOm",
            "object_type": "variable_workflow"
          },
          {
            "schema_id": "datatype.string",
            "properties": {
              "value": "white",
              "scope": "input",
              "name": "tlp",
              "type": "datatype.string",
              "is_required": false,
              "is_invisible": false
            },
            "unique_name": "variable_workflow_0209O0384JY6T1BgZioCCeLZ9HfuaP18HGa",
            "object_type": "variable_workflow"
          },
          {
            "schema_id": "datatype.string",
            "properties": {
              "value": "",
              "scope": "input",
              "name": "observable_value",
              "type": "datatype.string",
              "is_required": true,
              "is_invisible": false
            },
            "unique_name": "variable_workflow_0209O0384JIHT4rTbO3zWHGTKaAyePU8nZr",
            "object_type": "variable_workflow"
          },
          {
            "schema_id": "datatype.date",
            "properties": {
              "value": "0001-01-01T00:00:00+00:00",
              "scope": "local",
              "name": "Timestamp",
              "type": "datatype.date",
              "is_required": false,
              "is_invisible": false
            },
            "unique_name": "variable_workflow_0209O0384KHD80O3Ya4xHrildFfagV0wMMN",
            "object_type": "variable_workflow"
          }
        ],
        "properties": {
          "atomic": {
            "is_atomic": false
          },
          "delete_workflow_instance": false,
          "display_name": "Create Judgement",
          "runtime_user": {
            "target_default": true
          },
          "target": {
            "no_target": true
          }
        },
        "object_type": "definition_workflow",
        "actions": [
          {
            "unique_name": "definition_activity_0209O03AX1B6X6QYJRRZEGlWWwZZlZJ0Awl",
            "name": "Condition Block",
            "title": "If Disposition Name",
            "type": "logic.if_else",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "If Disposition Name",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "blocks": [
              {
                "unique_name": "definition_activity_0209O03BG3E016rA3IvRbUL54GETk5JxJa0",
                "name": "Condition Branch",
                "title": "Malicious",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": "$workflow.definition_workflow_0209O037OHHXE4cxu8dttkABb9AJa3g6tNY.input.variable_workflow_0209O0384J4RY1pUk1w4FxSOBSUFWIlJUoj$",
                    "operator": "eqi",
                    "right_operand": "malicious"
                  },
                  "continue_on_failure": false,
                  "display_name": "Malicious",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_0209O03CJCZK27EFXsVJZA7SpIY1ZanYHIw",
                    "name": "Set Variables",
                    "title": "Set Disposition",
                    "type": "core.set_multiple_variables",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Set Disposition",
                      "skip_execution": false,
                      "variables_to_update": [
                        {
                          "variable_to_update": "$workflow.definition_workflow_0209O037OHHXE4cxu8dttkABb9AJa3g6tNY.input.variable_workflow_0209O0384J4RY1pUk1w4FxSOBSUFWIlJUoj$",
                          "variable_value_new": "Malicious"
                        },
                        {
                          "variable_to_update": "$workflow.definition_workflow_0209O037OHHXE4cxu8dttkABb9AJa3g6tNY.local.variable_workflow_0209O0384L2HL79MKMU0X77dYaFIFrtDckP$",
                          "variable_value_new": 2
                        }
                      ]
                    },
                    "object_type": "definition_activity"
                  }
                ]
              },
              {
                "unique_name": "definition_activity_0209O03D62XU70f74CPZq2df66EnquKHsI4",
                "name": "Condition Branch",
                "title": "Suspicious",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": "$workflow.definition_workflow_0209O037OHHXE4cxu8dttkABb9AJa3g6tNY.input.variable_workflow_0209O0384J4RY1pUk1w4FxSOBSUFWIlJUoj$",
                    "operator": "eqi",
                    "right_operand": "suspicious"
                  },
                  "continue_on_failure": false,
                  "display_name": "Suspicious",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_0209O03DX7IN730CR8WivfD1eE9pXplwmC5",
                    "name": "Set Variables",
                    "title": "Set Disposition",
                    "type": "core.set_multiple_variables",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Set Disposition",
                      "skip_execution": false,
                      "variables_to_update": [
                        {
                          "variable_to_update": "$workflow.definition_workflow_0209O037OHHXE4cxu8dttkABb9AJa3g6tNY.input.variable_workflow_0209O0384J4RY1pUk1w4FxSOBSUFWIlJUoj$",
                          "variable_value_new": "Suspicious"
                        },
                        {
                          "variable_to_update": "$workflow.definition_workflow_0209O037OHHXE4cxu8dttkABb9AJa3g6tNY.local.variable_workflow_0209O0384L2HL79MKMU0X77dYaFIFrtDckP$",
                          "variable_value_new": 3
                        }
                      ]
                    },
                    "object_type": "definition_activity"
                  }
                ]
              },
              {
                "unique_name": "definition_activity_0209O03EPAM4V6G3YM5KIgzZZAKqom0qTlm",
                "name": "Condition Branch",
                "title": "Clean",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": "$workflow.definition_workflow_0209O037OHHXE4cxu8dttkABb9AJa3g6tNY.input.variable_workflow_0209O0384J4RY1pUk1w4FxSOBSUFWIlJUoj$",
                    "operator": "eqi",
                    "right_operand": "clean"
                  },
                  "continue_on_failure": false,
                  "display_name": "Clean",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_0209O03FIWLUC06IUl2L6xOaD2Mm6jZWHGb",
                    "name": "Set Variables",
                    "title": "Set Disposition",
                    "type": "core.set_multiple_variables",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Set Disposition",
                      "skip_execution": false,
                      "variables_to_update": [
                        {
                          "variable_to_update": "$workflow.definition_workflow_0209O037OHHXE4cxu8dttkABb9AJa3g6tNY.input.variable_workflow_0209O0384J4RY1pUk1w4FxSOBSUFWIlJUoj$",
                          "variable_value_new": "Clean"
                        },
                        {
                          "variable_to_update": "$workflow.definition_workflow_0209O037OHHXE4cxu8dttkABb9AJa3g6tNY.local.variable_workflow_0209O0384L2HL79MKMU0X77dYaFIFrtDckP$",
                          "variable_value_new": 1
                        }
                      ]
                    },
                    "object_type": "definition_activity"
                  }
                ]
              },
              {
                "unique_name": "definition_activity_0209O03G8VB6F30CdrjHDmVLggrCqcRTkxy",
                "name": "Condition Branch",
                "title": "Unknown",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": "$workflow.definition_workflow_0209O037OHHXE4cxu8dttkABb9AJa3g6tNY.input.variable_workflow_0209O0384J4RY1pUk1w4FxSOBSUFWIlJUoj$",
                    "operator": "eqi",
                    "right_operand": "unknown"
                  },
                  "continue_on_failure": false,
                  "display_name": "Unknown",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_0209O03H3SVOT1VujUZLDpVM6MsheXVRdJi",
                    "name": "Set Variables",
                    "title": "Set Disposition",
                    "type": "core.set_multiple_variables",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Set Disposition",
                      "skip_execution": false,
                      "variables_to_update": [
                        {
                          "variable_to_update": "$workflow.definition_workflow_0209O037OHHXE4cxu8dttkABb9AJa3g6tNY.input.variable_workflow_0209O0384J4RY1pUk1w4FxSOBSUFWIlJUoj$",
                          "variable_value_new": "Unknown"
                        },
                        {
                          "variable_to_update": "$workflow.definition_workflow_0209O037OHHXE4cxu8dttkABb9AJa3g6tNY.local.variable_workflow_0209O0384L2HL79MKMU0X77dYaFIFrtDckP$",
                          "variable_value_new": 5
                        }
                      ]
                    },
                    "object_type": "definition_activity"
                  }
                ]
              }
            ]
          },
          {
            "unique_name": "definition_activity_0209O03HP0LON4VWRFd9mpv4pdJdDxcadc8",
            "name": "Condition Block",
            "title": "If Confidence",
            "type": "logic.if_else",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "If Confidence",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "blocks": [
              {
                "unique_name": "definition_activity_0209O03ID6KSI6bOS45XpGtlQO6LYKM4YxA",
                "name": "Condition Branch",
                "title": "High",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": "$workflow.definition_workflow_0209O037OHHXE4cxu8dttkABb9AJa3g6tNY.input.variable_workflow_0209O0384JBJL1zGw1LokdAPOSFqmINazjY$",
                    "operator": "eqi",
                    "right_operand": "high"
                  },
                  "continue_on_failure": false,
                  "display_name": "High",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_0209O03J85SXK1UaFyiR89Z9zpP7SbrvELT",
                    "name": "Set Variables",
                    "title": "Set Confidence",
                    "type": "core.set_multiple_variables",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Set Confidence",
                      "skip_execution": false,
                      "variables_to_update": [
                        {
                          "variable_to_update": "$workflow.definition_workflow_0209O037OHHXE4cxu8dttkABb9AJa3g6tNY.input.variable_workflow_0209O0384JBJL1zGw1LokdAPOSFqmINazjY$",
                          "variable_value_new": "High"
                        }
                      ]
                    },
                    "object_type": "definition_activity"
                  }
                ]
              },
              {
                "unique_name": "definition_activity_0209O03JX2VPU2TeDw7NO3PncotgorGnnGw",
                "name": "Condition Branch",
                "title": "Medium",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": "$workflow.definition_workflow_0209O037OHHXE4cxu8dttkABb9AJa3g6tNY.input.variable_workflow_0209O0384JBJL1zGw1LokdAPOSFqmINazjY$",
                    "operator": "eqi",
                    "right_operand": "medium"
                  },
                  "continue_on_failure": false,
                  "display_name": "Medium",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_0209O03KQ33W21ScdGqbOYTqHb0UhMVO6tn",
                    "name": "Set Variables",
                    "title": "Set Confidence",
                    "type": "core.set_multiple_variables",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Set Confidence",
                      "skip_execution": false,
                      "variables_to_update": [
                        {
                          "variable_to_update": "$workflow.definition_workflow_0209O037OHHXE4cxu8dttkABb9AJa3g6tNY.input.variable_workflow_0209O0384JBJL1zGw1LokdAPOSFqmINazjY$",
                          "variable_value_new": "Medium"
                        }
                      ]
                    },
                    "object_type": "definition_activity"
                  }
                ]
              },
              {
                "unique_name": "definition_activity_0209O03LDTDRB6KAjJQZ64goWCO0m8MU6by",
                "name": "Condition Branch",
                "title": "Low",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": "$workflow.definition_workflow_0209O037OHHXE4cxu8dttkABb9AJa3g6tNY.input.variable_workflow_0209O0384JBJL1zGw1LokdAPOSFqmINazjY$",
                    "operator": "eqi",
                    "right_operand": "low"
                  },
                  "continue_on_failure": false,
                  "display_name": "Low",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_0209O03M60FZJ5LCpMGvUOIkPGXYhiDx41p",
                    "name": "Set Variables",
                    "title": "Set Confidence",
                    "type": "core.set_multiple_variables",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Set Confidence",
                      "skip_execution": false,
                      "variables_to_update": [
                        {
                          "variable_to_update": "$workflow.definition_workflow_0209O037OHHXE4cxu8dttkABb9AJa3g6tNY.input.variable_workflow_0209O0384JBJL1zGw1LokdAPOSFqmINazjY$",
                          "variable_value_new": "Low"
                        }
                      ]
                    },
                    "object_type": "definition_activity"
                  }
                ]
              },
              {
                "unique_name": "definition_activity_0209O03MUSZ8I6cenlUcpopnJEnSBIxaQF6",
                "name": "Condition Branch",
                "title": "Info",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": "$workflow.definition_workflow_0209O037OHHXE4cxu8dttkABb9AJa3g6tNY.input.variable_workflow_0209O0384JBJL1zGw1LokdAPOSFqmINazjY$",
                    "operator": "eqi",
                    "right_operand": "info"
                  },
                  "continue_on_failure": false,
                  "display_name": "Info",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_0209O03NMZ9DG56VCfBj5ddNVQMYGgQJMXq",
                    "name": "Set Variables",
                    "title": "Set Confidence",
                    "type": "core.set_multiple_variables",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Set Confidence",
                      "skip_execution": false,
                      "variables_to_update": [
                        {
                          "variable_to_update": "$workflow.definition_workflow_0209O037OHHXE4cxu8dttkABb9AJa3g6tNY.input.variable_workflow_0209O0384JBJL1zGw1LokdAPOSFqmINazjY$",
                          "variable_value_new": "Info"
                        }
                      ]
                    },
                    "object_type": "definition_activity"
                  }
                ]
              }
            ]
          },
          {
            "unique_name": "definition_activity_0209O03OPJY0X5w2Cea6TlIcCWPaWlUmk8I",
            "name": "Calculate Date",
            "title": "Calculate Date",
            "type": "core.calculate_date",
            "base_type": "activity",
            "properties": {
              "adjustment": "$workflow.definition_workflow_0209O037OHHXE4cxu8dttkABb9AJa3g6tNY.input.variable_workflow_0209O0384KP9D3v8WbEmUK4xhOant7WOfS3$*86400",
              "continue_on_failure": false,
              "display_name": "Calculate Date",
              "original_date": "$workflow.definition_workflow_0209O037OHHXE4cxu8dttkABb9AJa3g6tNY.output.start_time$",
              "skip_execution": false
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_0209O03PPJML14RxjK2rcjUUdu47bGygo1i",
            "name": "Format Date",
            "title": "Format Start Date",
            "type": "core.format_date",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Format Start Date",
              "format_string": "2006-01-02T15:04:05.999999999Z",
              "original_date": "$workflow.definition_workflow_0209O037OHHXE4cxu8dttkABb9AJa3g6tNY.output.start_time$",
              "skip_execution": false,
              "use_custom_format": false
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_0209O03QEVFT05rL6IrP6mT6eRoKMe6RYVP",
            "name": "Format Date",
            "title": "Format Valid Until Date",
            "type": "core.format_date",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Format Valid Until Date",
              "format_string": "2006-01-02T15:04:05.999999999Z",
              "original_date": "$activity.definition_activity_0209O03OPJY0X5w2Cea6TlIcCWPaWlUmk8I.output.result$",
              "skip_execution": false,
              "use_custom_format": false
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_0209O03S36NEA24MmqGxim66vcQHGiaQ0Fo",
            "name": "Set Variables",
            "title": "Set Variables",
            "type": "core.set_multiple_variables",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Set Variables",
              "skip_execution": false,
              "variables_to_update": [
                {
                  "variable_to_update": "$workflow.definition_workflow_0209O037OHHXE4cxu8dttkABb9AJa3g6tNY.output.variable_workflow_0209O0384K9L92OSO0hqZtY7OBLiWJhjrsc$",
                  "variable_value_new": "{\n\"valid_time\": {\n\"start_time\": \"$activity.definition_activity_0209O03PPJML14RxjK2rcjUUdu47bGygo1i.output.result$\",\n\"end_time\": \"$activity.definition_activity_0209O03QEVFT05rL6IrP6mT6eRoKMe6RYVP.output.result$\"\n},\n\"authorized_groups\": [\n\"$workflow.definition_workflow_0209O037OHHXE4cxu8dttkABb9AJa3g6tNY.input.variable_workflow_0209O0384IBIP7FLf8uNmcBdz2dAHDxFKEC$\"\n],\n\"schema_version\": \"1.1.3\",\n\"observable\": {\n\"value\": \"$workflow.definition_workflow_0209O037OHHXE4cxu8dttkABb9AJa3g6tNY.input.variable_workflow_0209O0384JIHT4rTbO3zWHGTKaAyePU8nZr$\",\n\"type\": \"$workflow.definition_workflow_0209O037OHHXE4cxu8dttkABb9AJa3g6tNY.input.variable_workflow_0209O0384JQEL6YwGc04mAwjV6eXbmvkTOm$\"\n},\n\"type\": \"judgement\",\n\"source\": \"$workflow.definition_workflow_0209O037OHHXE4cxu8dttkABb9AJa3g6tNY.input.variable_workflow_0209O0384IPGL5VYnn2tELLWJkPXfKpbdmF$\",\n\"disposition\": $workflow.definition_workflow_0209O037OHHXE4cxu8dttkABb9AJa3g6tNY.local.variable_workflow_0209O0384L2HL79MKMU0X77dYaFIFrtDckP$,\n\"reason\": \"string\",\n\"disposition_name\": \"$workflow.definition_workflow_0209O037OHHXE4cxu8dttkABb9AJa3g6tNY.input.variable_workflow_0209O0384J4RY1pUk1w4FxSOBSUFWIlJUoj$\",\n\"priority\": $workflow.definition_workflow_0209O037OHHXE4cxu8dttkABb9AJa3g6tNY.input.variable_workflow_0209O0384KW391cs7RmT8lulazuO19snQTX$,\n\"severity\": \"$workflow.definition_workflow_0209O037OHHXE4cxu8dttkABb9AJa3g6tNY.input.variable_workflow_0209O0384IXUQ7WwqdPNR1Zna8LRAFGdU7s$\",\n\"tlp\": \"$workflow.definition_workflow_0209O037OHHXE4cxu8dttkABb9AJa3g6tNY.input.variable_workflow_0209O0384JY6T1BgZioCCeLZ9HfuaP18HGa$\",\n\"timestamp\": \"$activity.definition_activity_0209O03PPJML14RxjK2rcjUUdu47bGygo1i.output.result$\",\n\"confidence\": \"$workflow.definition_workflow_0209O037OHHXE4cxu8dttkABb9AJa3g6tNY.input.variable_workflow_0209O0384JBJL1zGw1LokdAPOSFqmINazjY$\"\n}"
                }
              ]
            },
            "object_type": "definition_activity"
          }
        ],
        "categories": [
          "category_1BMfMXSnJMyt5Ihqi7rWJr5N8cf"
        ]
      }
    }
  ],
  "atomic_workflows": [
    "definition_workflow_0204GWQHPXIXZ3GOjMdVOzF9cezREUY0hX6",
    "definition_workflow_0204H2P2WWMIP4Gk094MfmJxPnILJcWt0DX",
    "definition_workflow_0204H5ZVN0ZN256UTZ86ZRCflW6pqrVR62m"
  ],
  "dependent_workflows": [
    "definition_workflow_020Y5S395W5234aoEemc0d9xgaYlfWvI0DX",
    "definition_workflow_0204GWQHPXIXZ3GOjMdVOzF9cezREUY0hX6",
    "definition_workflow_0204H2P2WWMIP4Gk094MfmJxPnILJcWt0DX",
    "definition_workflow_0204H5ZVN0ZN256UTZ86ZRCflW6pqrVR62m",
    "definition_workflow_0209O037OHHXE4cxu8dttkABb9AJa3g6tNY"
  ]
}